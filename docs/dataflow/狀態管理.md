# 狀態管理

## GroupService (@MainActor)

**發布屬性：**
- `currentGroup: HitherGroup?` - 當前活動群組
- `allUserGroups: [HitherGroup]` - 用戶所屬的所有群組
- `isLoading: Bool` - UI 的加載狀態
- `errorMessage: String?` - 用戶顯示的錯誤消息

**關鍵方法：**
- `createGroup()` - 創建新群組
- `joinGroup()` - 加入現有群組
- `leaveGroup()` - 離開群組並進行領導者轉移邏輯
- `loadUserGroups()` - 加載用戶的所有群組
- `cleanupGroupData()` - 修復損壞的群組數據

## AuthenticationService (@MainActor)

**發布屬性：**
- `isAuthenticated: Bool` - 用戶驗證狀態
- `currentUser: HitherUser?` - 當前已驗證用戶

## GoogleMapsService (@MainActor) 🆕

**發布屬性：**
- `searchResults: [PlaceResult]` - 搜尋結果
- `currentRoute: Route?` - 當前路線
- `isLoading: Bool` - API 請求狀態

**關鍵方法：**
- `searchPlaces(query:)` - Places API 搜尋
- `calculateRoute(from:to:)` - Routes API 路線計算
- `getPlaceDetails(placeId:)` - 地點詳情

## DirectionService (@MainActor) 🆕

**發布屬性：**
- `bearing: Double` - 方位角
- `distance: Double` - 距離
- `isUWBAvailable: Bool` - UWB 可用性

## CommandService (@MainActor) 🆕

**發布屬性：**
- `recentCommands: [Command]` - 最近命令
- `isLoading: Bool` - 發送狀態

## NotificationService (@MainActor) 🆕

**發布屬性：**
- `permissionStatus: UNAuthorizationStatus` - 通知權限
- `fcmToken: String?` - FCM 令牌
