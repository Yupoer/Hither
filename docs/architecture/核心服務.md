# 核心服務

## 1. AuthenticationService

**目的**：管理用戶驗證和會話狀態

**主要功能：**
- Firebase Auth 整合 (Google、Apple ID、電子郵件)
- 用戶會話管理
- 個人資料更新 (顯示名稱、照片)

**屬性：**
```swift
@Published var isAuthenticated: Bool
@Published var currentUser: HitherUser?
@Published var isLoading: Bool
```

**方法：**
- `signInWithGoogle()` - Google 登錄
- `signInWithApple()` - Apple 登錄
- `signOut()` - 用戶登出
- `updateProfile()` - 個人資料更新

## 6. GoogleMapsService 🆕

**目的**：Google Maps API 整合，取代 MapKit

**主要功能：**
- Google Maps 路線計算 (Routes API)
- Google Places 搜尋和自動完成 (Places API)
- Google Maps SDK for iOS 整合
- 路線顯示和導航

**API 配置：**
- API 金鑰：`AIzaSyCx0cyeUy7O4HEdZcGSlElYJibPVT5ciZQ`
- 允許的 API：Routes API、Places API (New)、Maps SDK for iOS

## 7. ThemeManager & ThemeConfiguration 🆕

**目的**：DarkBlue 主題系統管理

**主要功能：**
- OKLCH 色彩空間主題系統
- 自動明暗模式切換
- 主題組件工廠
- CSS 設計令牌整合

## 8. DirectionService 🆕

**目的**：方向計算和導航邏輯

**主要功能：**
- 指南針計算
- 距離計算
- UWB 精密定位整合
- 方向更新

## 9. CommandService 🆕

**目的**：廣播命令管理

**主要功能：**
- 預設命令管理
- 自訂訊息處理
- 推送通知觸發
- 命令歷史

## 10. NotificationService 🆕

**目的**：推送通知處理

**主要功能：**
- FCM 整合
- 通知類別管理
- 權限處理
- 本地通知

## 11. LanguageService 🆕

**目的**：多語言支援

**主要功能：**
- 語言切換
- 本地化字串管理
- 區域設定
- 動態語言更新

## 12. DevelopmentService 🆕

**目的**：開發工具和測試

**主要功能：**
- 模擬位置
- 測試數據生成
- 開發模式切換
- 除錯工具

### 2. GroupService

**目的**：核心群組管理和 Firebase 同步

**主要功能：**
- 群組創建和加入
- 實時成員同步
- 自動領導者轉移
- 數據驗證和修復

**屬性：**
```swift
@Published var currentGroup: HitherGroup?
@Published var allUserGroups: [HitherGroup]
@Published var isLoading: Bool
@Published var errorMessage: String?

方法：

createGroup() - 創建新群組

joinGroup() - 加入現有群組

leaveGroup() - 離開群組並清理

generateNewInviteCode() - 刷新邀請碼

cleanupGroupData() - 修復損壞的數據

fetchDashboardData() - [新增] 獲取主控台所需的所有聚合數據（如團隊狀態、最新指令等）。

## 3. LocationService

**目的**：GPS 位置追蹤和分享

**主要功能：**
- 背景位置更新
- 電池優化
- 權限管理
- 位置精度監控

## 4. ItineraryService

**目的**：航點和路線管理

**主要功能：**
- 航點創建和管理
- 路線計算
- 逐步導航
- 實時同步

## 5. LiveActivityService

**目的**：iOS 16.1+ Live Activities 整合

**主要功能：**
- 鎖屏距離顯示
- Dynamic Island 整合
- 實時更新
- 電池高效更新
